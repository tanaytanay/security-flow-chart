<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nodal Chart - Phase Tree</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .phase-info {
            background-color: #e8f4fd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        .phase-info h3 {
            margin-top: 0;
            color: #2980b9;
        }
        
        .mermaid {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Nodal Chart - Phase Tree Structure</h1>
        
        <div class="phase-info">
            <h3>Phase Structure:</h3>
            <ul>
                <li><strong>Phase 1:</strong> Single node (root)</li>
                <li><strong>Phase 2:</strong> Single node (child of Phase 1)</li>
                <li><strong>Phase 3:</strong> 1-5 nodes (all children of Phase 2)</li>
                <li><strong>Phase 4:</strong> Each Phase 3 node can have 1-5 child nodes</li>
            </ul>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="resetToDefault()">Reset to Default</button>
        </div>
        
        <div class="mermaid" id="chart">
            graph LR
                A((<strong>Attacker</strong>)) --> B["<div style='text-align: center;'><strong>VM</strong><br/><div style='display: flex; flex-direction: column; align-items: center; gap: 10px;'><div id='ingress-circle' style='width: 60px; height: 60px; border-radius: 50%; background: radial-gradient(circle, #3498db, #3498db); border: 2px solid #fff; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;'>ingress</div><div id='egress-circle' style='width: 60px; height: 60px; border-radius: 50%; background: radial-gradient(circle, #3498db, #3498db); border: 2px solid #fff; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;'>egress</div></div></div>"]
                B --> C1((Agent 1))
                B --> C2((Agent 2))
                B --> C3((Agent 3))
                B --> C4((Agent 4))
                C1 --> D1((<strong>LLM1</strong>))
                C1 --> D2((<strong>LLM2</strong>))
                C1 --> D8((<strong>LLM3</strong>))
                C2 --> D3((<strong>LLM1</strong>))
                C3 --> D4((<strong>LLM1</strong>))
                C3 --> D5((<strong>LLM2</strong>))
                C3 --> D6((<strong>LLM3</strong>))
                C3 --> D7((<strong>LLM4</strong>))
                C4 --> D9((<strong>LLM1</strong>))
                
                classDef phase1 fill: #3498db, color: #fff
                classDef phase2 fill: #a8a8a8, color: #fff
                classDef phase3 fill: #3498db, color: #fff
                classDef phase4 fill: #3498db, color: #fff
                
                class A phase1
                class B phase2
                class C1,C2,C3,C4 phase3
                class D1,D2,D3,D4,D5,D6,D7,D8,D9 phase4
        </div>
        
   
        

        
        <div style="margin-top: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
            <h3>Custom HTML Node Examples</h3>
            <p>Mermaid.js supports limited HTML but you can create custom nodes with:</p>
            <ul>
                <li><strong>Basic HTML tags:</strong> &lt;br/&gt;, &lt;strong&gt;, &lt;em&gt;</li>
                <li><strong>Custom styling:</strong> Different colors, shapes, borders</li>
                <li><strong>Node shapes:</strong> Circular, rectangular, and custom forms</li>
            </ul>
            
            <div style="margin-top: 15px;">
                <button class="btn" onclick="showCustomNodeExample()">Show Custom Node Example</button>
            </div>
            
            <div id="customExample" style="display: none; margin-top: 15px; padding: 15px; background: white; border-radius: 5px;">
                <h4>Advanced Custom Node Example:</h4>
                <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <div style="border: 2px solid #e74c3c; border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; text-align: center; min-width: 120px;">
                        <div style="font-size: 24px;">ðŸš€</div>
                        <div style="font-weight: bold;">Custom Node</div>
                        <div style="font-size: 12px; opacity: 0.8;">With HTML</div>
                    </div>
                    
                    <div style="border: 2px solid #3498db; border-radius: 50%; padding: 20px; background: radial-gradient(circle, #3498db, #2980b9); color: white; text-align: center; min-width: 120px; min-height: 120px; display: flex; flex-direction: column; justify-content: center;">
                        <div style="font-size: 20px;">ðŸ’¡</div>
                        <div style="font-weight: bold;">Circular</div>
                        <div style="font-size: 10px;">Node</div>
                    </div>
                    
                    <div style="border: 2px solid #2ecc71; border-radius: 0; padding: 15px; background: #2ecc71; color: white; text-align: center; min-width: 120px; transform: rotate(-5deg);">
                        <div style="font-size: 20px;">ðŸŽ¯</div>
                        <div style="font-weight: bold;">Angled</div>
                        <div style="font-size: 12px;">Target</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Random tree generation removed - not needed
        
        // Reset to default tree
        function resetToDefault() {
            location.reload();
        }
        
        // Show custom node examples
        function showCustomNodeExample() {
            const example = document.getElementById('customExample');
            if (example.style.display === 'none') {
                example.style.display = 'block';
            } else {
                example.style.display = 'none';
            }
        }
        
        // Auto-refresh when file changes (for development)
        let lastModified = Date.now();
        setInterval(() => {
            fetch(window.location.href, { method: 'HEAD' })
                .then(response => {
                    const lastModifiedHeader = response.headers.get('last-modified');
                    if (lastModifiedHeader) {
                        const modifiedTime = new Date(lastModifiedHeader).getTime();
                        if (modifiedTime > lastModified) {
                            lastModified = modifiedTime;
                            location.reload();
                        }
                    }
                })
                .catch(() => {});
        }, 2000);
        
                // Custom Phase 2 node overlay removed - using direct Mermaid customization instead
        
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                nodeSpacing: 20,
                rankSpacing: 200,
            }
        });
        

    </script>
</body>
</html>
